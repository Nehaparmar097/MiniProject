<!-- <!DOCTYPE html>
<html>
<head>
    <title>Login Page</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f4f4f4;
        }
        .container {
            background-color: #fff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            margin-bottom: 20px;
        }
        .form-control {
            margin-bottom: 15px;
        }
        .btn-success {
            width: 100%;
        }
    </style>
    <script>
        const login = () => {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            fetch('http://localhost:5190/api/User/Login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    email: email,
                    password: password
                })
            })
            .then(res => {
                if (!res.ok) {
                    return res.json().then(err => { throw new Error(err.title || 'Login failed'); });
                }
                return res.json();
            })
            .then(data => {
                console.log(data);
                localStorage.setItem('token', data.token);
                localStorage.setItem('role', data.role); // Assuming the API returns a 'role' field

                if (data.role === 'Donor') {
                    window.location.href = './Donor/Donor.html'; // Redirect to donor management page
                } else {
                    alert('Login successful, but not a Donor');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Login failed: ' + error.message);
            });
        }
    </script>
</head>
<body>
    <div class="container">
        <h1>Login</h1>
        <div class="mb-3">
            <input class="form-control" type="email" id="email" placeholder="Enter your email" required />
        </div>
        <div class="mb-3">
            <input class="form-control" type="password" id="password" placeholder="Enter your password" required />
        </div>
        <div class="mb-3">
            <button class="btn btn-success" onclick="login()">Login</button>
        </div>
    </div>
</body>
</html> -->
<!DOCTYPE html>
<html>
<head>
    <title>Login Page</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f4f4f4;
        }
        .container {
            background-color: #fff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            margin-bottom: 20px;
        }
        .form-control {
            margin-bottom: 15px;
        }
        .btn-success {
            width: 100%;
        }
    </style>
    <script>
        const login = () => {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            fetch('http://localhost:5190/api/User/Login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ email, password })
            })
            .then(res => {
                if (!res.ok) {
                    return res.json().then(err => { throw new Error(err.title || 'Login failed'); });
                }
                return res.json();
            })
            .then(data => {
                console.log(data); // Log the entire response for debugging purposes

                // Store token and role in localStorage
                localStorage.setItem('token', data.token);
                localStorage.setItem('role', data.role);
                localStorage.setItem('userID', data.userID); // Store userID in localStorage

                // Check the user role and redirect accordingly
                if (data.role === 'Donor') {
                    window.location.href = './Donor/Donor.html';
                } else if (data.role === 'Recipient') {
                    window.location.href = './Recipient/Recipient.html';
                } else {
                    alert('Login successful, but user role is not recognized.');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Login failed: ' + error.message);
            });
        }
    </script>
</head>
<body>
    <div class="container">
        <h1>Login</h1>
        <div class="mb-3">
            <input class="form-control" type="email" id="email" placeholder="Enter your email" required />
        </div>
        <div class="mb-3">
            <input class="form-control" type="password" id="password" placeholder="Enter your password" required />
        </div>
        <div class="mb-3">
            <button class="btn btn-success" onclick="login()">Login</button>
        </div>
    </div>
</body>
</html>
